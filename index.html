<!DOCTYPE html>
<html lang="lo">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡ªÅ‡∫≠‡∫±‡∫ö‡∫Ñ‡∫¥‡∫î‡ªÑ‡∫•‡ªà‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Lao:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans Lao', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            max-width: 414px;
            margin: 0 auto;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Splash Screen */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 414px;
            height: 100vh;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 400% 400%;
            animation: gradientShift 3s ease infinite;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.5s ease-out;
        }

        .splash-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .splash-logo {
            font-size: 4em;
            animation: bounce 2s infinite, rotate 3s linear infinite;
            margin-bottom: 20px;
        }

        .splash-text {
            color: white;
            font-size: 1.5em;
            font-weight: 600;
            text-align: center;
            animation: slideInUp 1s ease-out;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0) rotate(0deg); }
            40% { transform: translateY(-30px) rotate(180deg); }
            60% { transform: translateY(-15px) rotate(270deg); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Navigation */
        .nav-container {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 414px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .nav-tabs {
            display: flex;
            justify-content: space-around;
            padding: 10px 5px;
            border-radius: 0 0 20px 20px;
        }

        .tab {
            flex: 1;
            padding: 8px 4px;
            text-align: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-family: 'Noto Sans Lao', sans-serif;
            font-size: 0.7em;
            font-weight: 500;
            margin: 0 2px;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
        }

        .tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .tab.active {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(240, 147, 251, 0.5);
        }

        .tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .tab:hover::before {
            left: 100%;
        }

        /* Content */
        .content {
            padding: 80px 15px 20px;
            min-height: 100vh;
        }

        .page {
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .page.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Home Page */
        .home-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .date-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .date-input {
            padding: 10px;
            border: 2px solid #e0e6ed;
            border-radius: 15px;
            font-family: 'Noto Sans Lao', sans-serif;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }

        .date-input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .status-display {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .emoji-display {
            font-size: 4em;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.3));
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .details {
            flex: 1;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
        }

        .amount {
            font-weight: 600;
            font-size: 1.1em;
        }

        .income { color: #27ae60; }
        .expense { color: #e74c3c; }

        .status-message {
            text-align: center;
            padding: 15px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 1.1em;
            animation: pulse 2s infinite;
        }

        .status-message.positive {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }

        .status-message.negative {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        /* Form styles */
        .form-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e6ed;
            border-radius: 15px;
            font-family: 'Noto Sans Lao', sans-serif;
            font-size: 1em;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }

        .form-input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.3);
            transform: translateY(-2px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            font-family: 'Noto Sans Lao', sans-serif;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:active {
            transform: translateY(-1px);
        }

        /* Floating Add Button */
        .floating-btn {
            position: fixed;
            bottom: 20px;
            right: 50%;
            transform: translateX(calc(50% - 25px));
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #f093fb, #f5576c);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(240, 147, 251, 0.4);
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 999;
            animation: floatBtn 3s ease-in-out infinite;
        }

        @keyframes floatBtn {
            0%, 100% { transform: translateX(calc(50% - 25px)) translateY(0px); }
            50% { transform: translateX(calc(50% - 25px)) translateY(-5px); }
        }

        .floating-btn:hover {
            transform: translateX(calc(50% - 25px)) scale(1.1);
            box-shadow: 0 12px 35px rgba(240, 147, 251, 0.6);
        }

        /* Item List */
        .item-list {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            transition: all 0.3s ease;
            animation: slideInRight 0.5s ease-out;
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .list-item:hover {
            background: rgba(102, 126, 234, 0.2);
            transform: translateX(5px);
        }

        .item-details {
            flex: 1;
        }

        .item-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .item-date {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .item-amount {
            font-weight: 600;
            font-size: 1.2em;
        }

        .delete-btn {
            background: #e74c3c;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: #c0392b;
            transform: scale(1.1);
        }

        /* Summary Page */
        .summary-table {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid #e0e6ed;
            font-size: 0.9em;
        }

        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
            border-radius: 10px 10px 0 0;
        }

        .export-btn {
            margin-top: 15px;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 414px;
            height: 100vh;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 25px;
            padding: 30px;
            width: 90%;
            max-width: 350px;
            animation: modalSlide 0.3s ease-out;
        }

        @keyframes modalSlide {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #e74c3c;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
        }

        .search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: end;
        }

        .search-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 15px;
            cursor: pointer;
            font-family: 'Noto Sans Lao', sans-serif;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
        }

        /* Responsive adjustments */
        @media (max-width: 414px) {
            .tab {
                font-size: 0.6em;
                padding: 6px 2px;
            }
            
            .content {
                padding: 75px 10px 20px;
            }
            
            .emoji-display {
                font-size: 3em;
            }
            
            .status-display {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-logo">üí∞</div>
        <div class="splash-text">‡ªÅ‡∫≠‡∫±‡∫ö‡∫Ñ‡∫¥‡∫î‡ªÑ‡∫•‡ªà‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç</div>
    </div>

    <!-- Navigation -->
    <div class="nav-container">
        <div class="nav-tabs">
            <button class="tab active" data-page="home">‡ªú‡ªâ‡∫≤‡∫´‡∫º‡∫±‡∫Å</button>
            <button class="tab" data-page="expenses">‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç</button>
            <button class="tab" data-page="income">‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö</button>
            <button class="tab" data-page="special">‡∫û‡∫¥‡ªÄ‡∫™‡∫î</button>
            <button class="tab" data-page="summary">‡∫™‡∫∞‡∫´‡∫º‡∫∏‡∫ö</button>
        </div>
    </div>

    <!-- Content -->
    <div class="content">
        <!-- Home Page -->
        <div class="page active" id="home">
            <div class="home-content">
                <div class="date-selector">
                    <label class="form-label">‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å‡∫ß‡∫±‡∫ô‡∫ó‡∫µ:</label>
                    <input type="date" class="date-input" id="homeDate">
                </div>
                
                <div class="status-display">
                    <div class="emoji-display" id="statusEmoji">üòä</div>
                    <div class="details">
                        <div class="detail-item">
                            <span>‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö:</span>
                            <span class="amount income" id="totalIncome">0 ‡∫Å‡∫µ‡∫ö</span>
                        </div>
                        <div class="detail-item">
                            <span>‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç:</span>
                            <span class="amount expense" id="totalExpenses">0 ‡∫Å‡∫µ‡∫ö</span>
                        </div>
                    </div>
                </div>
                
                <div class="status-message positive" id="statusMessage">‡ªÄ‡∫Æ‡∫±‡∫î‡ªÑ‡∫î‡ªâ‡∫î‡∫µ! üòä</div>
            </div>
        </div>

        <!-- Expenses Page -->
        <div class="page" id="expenses">
            <div class="form-container">
                <div class="search-container">
                    <div class="form-group" style="flex: 1; margin-bottom: 0;">
                        <label class="form-label">‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å‡∫ß‡∫±‡∫ô‡∫ó‡∫µ:</label>
                        <input type="date" class="form-input" id="expenseSearchDate">
                    </div>
                    <button class="search-btn" onclick="searchExpenses()">‡∫Ñ‡∫ª‡ªâ‡∫ô‡∫´‡∫≤</button>
                </div>
                
                <div class="item-list" id="expenseList">
                    <!-- Expense items will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Income Page -->
        <div class="page" id="income">
            <div class="form-container">
                <div class="search-container">
                    <div class="form-group" style="flex: 1; margin-bottom: 0;">
                        <label class="form-label">‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å‡∫ß‡∫±‡∫ô‡∫ó‡∫µ:</label>
                        <input type="date" class="form-input" id="incomeSearchDate">
                    </div>
                    <button class="search-btn" onclick="searchIncome()">‡∫Ñ‡∫ª‡ªâ‡∫ô‡∫´‡∫≤</button>
                </div>
                
                <div class="item-list" id="incomeList">
                    <!-- Income items will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Special Income Page -->
        <div class="page" id="special">
            <div class="form-container">
                <div class="search-container">
                    <div class="form-group" style="flex: 1; margin-bottom: 0;">
                        <label class="form-label">‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å‡∫ß‡∫±‡∫ô‡∫ó‡∫µ:</label>
                        <input type="date" class="form-input" id="specialSearchDate">
                    </div>
                    <button class="search-btn" onclick="searchSpecial()">‡∫Ñ‡∫ª‡ªâ‡∫ô‡∫´‡∫≤</button>
                </div>
                
                <div class="item-list" id="specialList">
                    <!-- Special income items will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Summary Page -->
        <div class="page" id="summary">
            <div class="form-container">
                <div class="search-container">
                    <div class="form-group" style="flex: 1; margin-bottom: 0;">
                        <label class="form-label">‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å‡ªÄ‡∫î‡∫∑‡∫≠‡∫ô:</label>
                        <input type="month" class="form-input" id="summaryMonth">
                    </div>
                    <button class="search-btn" onclick="generateSummary()">‡∫Ñ‡∫ª‡ªâ‡∫ô‡∫´‡∫≤</button>
                </div>
                
                <div class="summary-table" id="summaryTable" style="display: none;">
                    <table>
                        <thead>
                            <tr>
                                <th>‡∫ß‡∫±‡∫ô‡∫ó‡∫µ</th>
                                <th>‡∫õ‡∫∞‡ªÄ‡∫û‡∫î</th>
                                <th>‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô</th>
                                <th>‡∫à‡∫≥‡∫ô‡∫ß‡∫ô</th>
                            </tr>
                        </thead>
                        <tbody id="summaryBody">
                        </tbody>
                    </table>
                    <button class="btn-primary export-btn" onclick="exportData()">Export CSV</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Add Button -->
    <button class="floating-btn" id="floatingBtn" onclick="openAddModal()">+</button>

    <!-- Add Item Modal -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeAddModal()">&times;</button>
            <h3 id="modalTitle">‡ªÄ‡∫û‡∫µ‡ªà‡∫°‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô</h3>
            
            <div class="form-group">
                <label class="form-label">‡∫ä‡∫∑‡ªà‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô:</label>
                <input type="text" class="form-input" id="itemName" placeholder="‡ªÉ‡∫™‡ªà‡∫ä‡∫∑‡ªà‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô">
            </div>
            
            <div class="form-group">
                <label class="form-label">‡∫à‡∫≥‡∫ô‡∫ß‡∫ô‡ªÄ‡∫á‡∫¥‡∫ô:</label>
                <input type="number" class="form-input" id="itemAmount" placeholder="0">
            </div>
            
            <div class="form-group">
                <label class="form-label">‡∫ß‡∫±‡∫ô‡∫ó‡∫µ:</label>
                <input type="date" class="form-input" id="itemDate">
            </div>
            
            <button class="btn-primary" onclick="addItem()" style="width: 100%;">‡ªÄ‡∫û‡∫µ‡ªà‡∫°</button>
        </div>
    </div>

    <script>
        // Global variables
        let currentPage = 'home';
        let expenses = [];
        let income = [];
        let specialIncome = [];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Show splash screen for 3 seconds
            setTimeout(() => {
                document.getElementById('splashScreen').classList.add('hidden');
            }, 3000);

            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('homeDate').value = today;
            document.getElementById('itemDate').value = today;

            // Load data from storage or initialize
            loadData();
            updateHomePage();
            
            // Add event listeners
            setupEventListeners();
        });

        function setupEventListeners() {
            // Tab navigation
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    switchTab(e.target.dataset.page);
                });
            });

            // Date change on home page
            document.getElementById('homeDate').addEventListener('change', updateHomePage);
        }

        function switchTab(page) {
            // Update active tab
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`[data-page="${page}"]`).classList.add('active');

            // Show/hide pages
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(page).classList.add('active');

            currentPage = page;

            // Show/hide floating button based on page
            const floatingBtn = document.getElementById('floatingBtn');
            if (['expenses', 'income', 'special'].includes(page)) {
                floatingBtn.style.display = 'block';
            } else {
                floatingBtn.style.display = 'none';
            }

            // Load page-specific data
            if (page === 'expenses') loadExpenses();
            else if (page === 'income') loadIncome();
            else if (page === 'special') loadSpecial();
        }

        function loadData() {
            // In a real app, this would load from localStorage or a database
            // For demo purposes, we'll use empty arrays
            expenses = [];
            income = [];
            specialIncome = [];
        }

        function updateHomePage() {
            const selectedDate = document.getElementById('homeDate').value;
            
            // Calculate totals for selected date
            const dayExpenses = expenses.filter(item => item.date === selectedDate);
            const dayIncome = [...income, ...specialIncome].filter(item => item.date === selectedDate);
            
            const totalExpenses = dayExpenses.reduce((sum, item) => sum + item.amount, 0);
            const totalIncome = dayIncome.reduce((sum, item) => sum + item.amount, 0);
            
            // Update display
            document.getElementById('totalExpenses').textContent = `${totalExpenses.toLocaleString()} ‡∫Å‡∫µ‡∫ö`;
            document.getElementById('totalIncome').textContent = `${totalIncome.toLocaleString()} ‡∫Å‡∫µ‡∫ö`;
            
            // Update status
            const balance = totalIncome - totalExpenses;
            const statusEmoji = document.getElementById('statusEmoji');
            const statusMessage = document.getElementById('statusMessage');
            
            if (balance < 0) {
                statusEmoji.textContent = 'üò†';
                statusMessage.textContent = '‡ªÉ‡∫ä‡ªâ‡ªÄ‡∫Å‡∫µ‡∫ô‡∫á‡∫ª‡∫ö! üò†';
                statusMessage.className = 'status-message negative';
            } else {
                statusEmoji.textContent = 'üòä';
                statusMessage.textContent = '‡ªÄ‡∫Æ‡∫±‡∫î‡ªÑ‡∫î‡ªâ‡∫î‡∫µ! üòä';
                statusMessage.className = 'status-message positive';
            }
        }

        function openAddModal() {
            const modal = document.getElementById('addModal');
            const modalTitle = document.getElementById('modalTitle');
            
            // Set modal title based on current page
            if (currentPage === 'expenses') {
                modalTitle.textContent = '‡ªÄ‡∫û‡∫µ‡ªà‡∫°‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç';
            } else if (currentPage === 'income') {
                modalTitle.textContent = '‡ªÄ‡∫û‡∫µ‡ªà‡∫°‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö';
            } else if (currentPage === 'special') {
                modalTitle.textContent = '‡ªÄ‡∫û‡∫µ‡ªà‡∫°‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö‡∫û‡∫¥‡ªÄ‡∫™‡∫î';
            }
            
            modal.style.display = 'block';
        }

        function closeAddModal() {
            document.getElementById('addModal').style.display = 'none';
            // Clear form
            document.getElementById('itemName').value = '';
            document.getElementById('itemAmount').value = '';
        }

        function addItem() {
            const name = document.getElementById('itemName').value;
            const amount = parseFloat(document.getElementById('itemAmount').value);
            const date = document.getElementById('itemDate').value;

            if (!name || !amount || !date) {
                alert('‡∫Å‡∫∞‡∫•‡∫∏‡∫ô‡∫≤‡ªÉ‡∫™‡ªà‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô‡ªÉ‡∫´‡ªâ‡∫Ñ‡∫ª‡∫ö‡∫ñ‡ªâ‡∫ß‡∫ô');
                return;
            }

            const item = {
                id: Date.now(),
                name: name,
                amount: amount,
                date: date
            };

            // Add to appropriate array
            if (currentPage === 'expenses') {
                expenses.push(item);
                loadExpenses();
            } else if (currentPage === 'income') {
                income.push(item);
                loadIncome();
            } else if (currentPage === 'special') {
                specialIncome.push(item);
                loadSpecial();
            }

            closeAddModal();
            updateHomePage();
        }

        function deleteItem(type, id) {
            if (confirm('‡∫ï‡ªâ‡∫≠‡∫á‡∫Å‡∫≤‡∫ô‡∫•‡∫∂‡∫ö‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô‡∫ô‡∫µ‡ªâ‡∫ö‡ªç?')) {
                if (type === 'expense') {
                    expenses = expenses.filter(item => item.id !== id);
                    loadExpenses();
                } else if (type === 'income') {
                    income = income.filter(item => item.id !== id);
                    loadIncome();
                } else if (type === 'special') {
                    specialIncome = specialIncome.filter(item => item.id !== id);
                    loadSpecial();
                }
                updateHomePage();
            }
        }

        function loadExpenses() {
            const list = document.getElementById('expenseList');
            const searchDate = document.getElementById('expenseSearchDate').value;
            
            let filteredExpenses = expenses;
            if (searchDate) {
                filteredExpenses = expenses.filter(item => item.date === searchDate);
            }
            
            if (filteredExpenses.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">‡∫ö‡ªç‡ªà‡∫°‡∫µ‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç</p>';
                return;
            }
            
            list.innerHTML = filteredExpenses.map(item => `
                <div class="list-item">
                    <div class="item-details">
                        <div class="item-name">${item.name}</div>
                        <div class="item-date">${formatDate(item.date)}</div>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <div class="item-amount expense">${item.amount.toLocaleString()} ‡∫Å‡∫µ‡∫ö</div>
                        <button class="delete-btn" onclick="deleteItem('expense', ${item.id})">√ó</button>
                    </div>
                </div>
            `).join('');
        }

        function loadIncome() {
            const list = document.getElementById('incomeList');
            const searchDate = document.getElementById('incomeSearchDate').value;
            
            let filteredIncome = income;
            if (searchDate) {
                filteredIncome = income.filter(item => item.date === searchDate);
            }
            
            if (filteredIncome.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">‡∫ö‡ªç‡ªà‡∫°‡∫µ‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö</p>';
                return;
            }
            
            list.innerHTML = filteredIncome.map(item => `
                <div class="list-item">
                    <div class="item-details">
                        <div class="item-name">${item.name}</div>
                        <div class="item-date">${formatDate(item.date)}</div>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <div class="item-amount income">${item.amount.toLocaleString()} ‡∫Å‡∫µ‡∫ö</div>
                        <button class="delete-btn" onclick="deleteItem('income', ${item.id})">√ó</button>
                    </div>
                </div>
            `).join('');
        }

        function loadSpecial() {
            const list = document.getElementById('specialList');
            const searchDate = document.getElementById('specialSearchDate').value;
            
            let filteredSpecial = specialIncome;
            if (searchDate) {
                filteredSpecial = specialIncome.filter(item => item.date === searchDate);
            }
            
            if (filteredSpecial.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">‡∫ö‡ªç‡ªà‡∫°‡∫µ‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö‡∫û‡∫¥‡ªÄ‡∫™‡∫î</p>';
                return;
            }
            
            list.innerHTML = filteredSpecial.map(item => `
                <div class="list-item">
                    <div class="item-details">
                        <div class="item-name">${item.name}</div>
                        <div class="item-date">${formatDate(item.date)}</div>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <div class="item-amount income">${item.amount.toLocaleString()} ‡∫Å‡∫µ‡∫ö</div>
                        <button class="delete-btn" onclick="deleteItem('special', ${item.id})">√ó</button>
                    </div>
                </div>
            `).join('');
        }

        function searchExpenses() {
            loadExpenses();
        }

        function searchIncome() {
            loadIncome();
        }

        function searchSpecial() {
            loadSpecial();
        }

        function generateSummary() {
            const selectedMonth = document.getElementById('summaryMonth').value;
            
            if (!selectedMonth) {
                alert('‡∫Å‡∫∞‡∫•‡∫∏‡∫ô‡∫≤‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å‡ªÄ‡∫î‡∫∑‡∫≠‡∫ô');
                return;
            }
            
            const [year, month] = selectedMonth.split('-');
            
            // Filter all items for the selected month
            const monthExpenses = expenses.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate.getFullYear() == year && itemDate.getMonth() + 1 == month;
            });
            
            const monthIncome = income.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate.getFullYear() == year && itemDate.getMonth() + 1 == month;
            });
            
            const monthSpecial = specialIncome.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate.getFullYear() == year && itemDate.getMonth() + 1 == month;
            });
            
            // Combine and sort all items by date
            const allItems = [
                ...monthExpenses.map(item => ({ ...item, type: '‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç', class: 'expense' })),
                ...monthIncome.map(item => ({ ...item, type: '‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö', class: 'income' })),
                ...monthSpecial.map(item => ({ ...item, type: '‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö‡∫û‡∫¥‡ªÄ‡∫™‡∫î', class: 'income' }))
            ].sort((a, b) => new Date(a.date) - new Date(b.date));
            
            const summaryBody = document.getElementById('summaryBody');
            const summaryTable = document.getElementById('summaryTable');
            
            if (allItems.length === 0) {
                summaryBody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: #7f8c8d;">‡∫ö‡ªç‡ªà‡∫°‡∫µ‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô‡ªÉ‡∫ô‡ªÄ‡∫î‡∫∑‡∫≠‡∫ô‡∫ô‡∫µ‡ªâ</td></tr>';
            } else {
                summaryBody.innerHTML = allItems.map(item => `
                    <tr>
                        <td>${formatDate(item.date)}</td>
                        <td>${item.type}</td>
                        <td>${item.name}</td>
                        <td class="${item.class}">${item.amount.toLocaleString()} ‡∫Å‡∫µ‡∫ö</td>
                    </tr>
                `).join('');
            }
            
            summaryTable.style.display = 'block';
            
            // Store current summary data for export
            window.currentSummaryData = allItems;
        }

        function exportData() {
            if (!window.currentSummaryData || window.currentSummaryData.length === 0) {
                alert('‡∫ö‡ªç‡ªà‡∫°‡∫µ‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô‡∫™‡∫≥‡∫•‡∫±‡∫ö Export');
                return;
            }

            // Create CSV content
            const csvContent = [
                ['‡∫ß‡∫±‡∫ô‡∫ó‡∫µ', '‡∫õ‡∫∞‡ªÄ‡∫û‡∫î', '‡∫•‡∫≤‡∫ç‡∫Å‡∫≤‡∫ô', '‡∫à‡∫≥‡∫ô‡∫ß‡∫ô'],
                ...window.currentSummaryData.map(item => [
                    formatDate(item.date),
                    item.type,
                    item.name,
                    item.amount
                ])
            ].map(row => row.join(',')).join('\n');

            // Create and download file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `‡∫™‡∫∞‡∫´‡∫º‡∫∏‡∫ö‡∫•‡∫≤‡∫ç‡∫Æ‡∫±‡∫ö‡∫•‡∫≤‡∫ç‡∫à‡ªà‡∫≤‡∫ç_${new Date().toISOString().slice(0, 10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const months = [
                '‡∫°‡∫±‡∫á‡∫Å‡∫≠‡∫ô', '‡∫Å‡∫∏‡∫°‡∫û‡∫≤', '‡∫°‡∫µ‡∫ô‡∫≤', '‡ªÄ‡∫°‡∫™‡∫≤', '‡∫û‡∫∂‡∫î‡∫™‡∫∞‡∫û‡∫≤', '‡∫°‡∫¥‡∫ñ‡∫∏‡∫ô‡∫≤',
                '‡∫Å‡ªç‡∫•‡∫∞‡∫Å‡∫ª‡∫î', '‡∫™‡∫¥‡∫á‡∫´‡∫≤', '‡∫Å‡∫±‡∫ô‡∫ç‡∫≤', '‡∫ï‡∫∏‡∫•‡∫≤', '‡∫û‡∫∞‡∫à‡∫¥‡∫Å', '‡∫ó‡∫±‡∫ô‡∫ß‡∫≤'
            ];
            return `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
        }

        // Close modal when clicking outside
        document.getElementById('addModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAddModal();
            }
        });

        // Sample data for demonstration
        setTimeout(() => {
            // Add some sample data
            expenses.push(
                { id: 1, name: '‡∫ä‡∫∑‡ªâ‡ªÄ‡∫Ç‡∫ª‡ªâ‡∫≤', amount: 50000, date: '2024-08-21' },
                { id: 2, name: '‡∫ô‡ªâ‡∫≥‡∫°‡∫±‡∫ô‡∫•‡∫ª‡∫î', amount: 100000, date: '2024-08-21' },
                { id: 3, name: '‡∫Ñ‡ªà‡∫≤‡ªÑ‡∫ü', amount: 200000, date: '2024-08-20' }
            );
            
            income.push(
                { id: 4, name: '‡ªÄ‡∫á‡∫¥‡∫ô‡ªÄ‡∫î‡∫∑‡∫≠‡∫ô', amount: 3000000, date: '2024-08-21' },
                { id: 5, name: '‡∫Ç‡∫≤‡∫ç‡ªÄ‡∫Ñ‡∫∑‡ªà‡∫≠‡∫á', amount: 500000, date: '2024-08-20' }
            );
            
            specialIncome.push(
                { id: 6, name: '‡ªÇ‡∫ö‡∫ô‡∫±‡∫î', amount: 1000000, date: '2024-08-21' }
            );
            
            updateHomePage();
        }, 3500);
    </script>
</body>
</html>